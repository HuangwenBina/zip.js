!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).zip={})}(this,(function(t){"use strict";const e="function";function r(t,r){return class{constructor(n){const i=t=>{if(this.pendingData){const e=this.pendingData;this.pendingData=new Uint8Array(e.length+t.length),this.pendingData.set(e,0),this.pendingData.set(t,e.length)}else this.pendingData=new Uint8Array(t)};if(this.codec=new t(Object.assign({},r,n)),typeof this.codec.onData==e)this.codec.onData=i;else{if(typeof this.codec.on!=e)throw new Error("Cannot register the callback function");this.codec.on("data",i)}}async append(t){return this.codec.push(t),n(this)}async flush(){return this.codec.push(new Uint8Array(0),!0),n(this)}};function n(t){if(t.pendingData){const e=t.pendingData;return t.pendingData=null,e}return new Uint8Array(0)}}const n=4294967295,i=65535,s=67324752,a=134695760,o=33639248,c=101010256,d=101075792,h=117853008,l=39169,u=2048,p=["\0","☺","☻","♥","♦","♣","♠","•","◘","○","◙","♂","♀","♪","♫","☼","►","◄","↕","‼","¶","§","▬","↨","↑","↓","→","←","∟","↔","▲","▼"," ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/","0","1","2","3","4","5","6","7","8","9",":",";","<","=",">","?","@","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","[","\\","]","^","_","`","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}","~","⌂","Ç","ü","é","â","ä","à","å","ç","ê","ë","è","ï","î","ì","Ä","Å","É","æ","Æ","ô","ö","ò","û","ù","ÿ","Ö","Ü","¢","£","¥","₧","ƒ","á","í","ó","ú","ñ","Ñ","ª","º","¿","⌐","¬","½","¼","¡","«","»","░","▒","▓","│","┤","╡","╢","╖","╕","╣","║","╗","╝","╜","╛","┐","└","┴","┬","├","─","┼","╞","╟","╚","╔","╩","╦","╠","═","╬","╧","╨","╤","╥","╙","╘","╒","╓","╫","╪","┘","┌","█","▄","▌","▐","▀","α","ß","Γ","π","Σ","σ","µ","τ","Φ","Θ","Ω","δ","∞","φ","ε","∩","≡","±","≥","≤","⌠","⌡","÷","≈","°","∙","·","√","ⁿ","²","■"," "];class w{constructor(){this.crc=-1,this.table=(()=>{const t=[];for(let e=0;e<256;e++){let r=e;for(let t=0;t<8;t++)1&r?r=r>>>1^3988292384:r>>>=1;t[e]=r}return t})()}append(t){const e=this.table;let r=0|this.crc;for(let n=0,i=0|t.length;n<i;n++)r=r>>>8^e[255&(r^t[n])];this.crc=r}get(){return~this.crc}}const f="Invalid pasword",g=16,y="raw",m={name:"PBKDF2"},b={name:"HMAC"},E="SHA-1",U={name:"AES-CTR"},A=Object.assign({hash:b},m),R=Object.assign({iterations:1e3,hash:{name:E}},m),D=Object.assign({hash:E},b),x=Object.assign({length:g},U),F=["deriveBits"],S=["sign"],T=10,I=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],k=crypto.subtle;class v{constructor(t,e){this.password=t,this.signed=e,this.input=e&&new Uint8Array(0),this.pendingInput=new Uint8Array(0)}async append(t){const e=async(i=0)=>{if(i+g<=n.length-T){const t=n.subarray(i,i+g),s=await k.decrypt(Object.assign({counter:this.counter},x),this.keys.key,t);return L(this.counter),r.set(new Uint8Array(s),i),e(i+g)}return this.pendingInput=n.subarray(i),this.signed&&(this.input=_(this.input,t)),r};if(this.password){const e=t.subarray(0,18);await async function(t,e,r){await C(t,r,e.subarray(0,16),["decrypt"]);const n=e.subarray(16),i=t.keys.passwordVerification;if(i[0]!=n[0]||i[1]!=n[1])throw new Error(f)}(this,e,this.password),this.password=null,t=t.subarray(18)}let r=new Uint8Array(t.length-T-(t.length-T)%g),n=t;return this.pendingInput.length&&(n=_(this.pendingInput,t),r=W(r,n.length-T-(n.length-T)%g)),e()}async flush(){const t=this.pendingInput,e=this.keys,r=t.subarray(0,t.length-T),n=t.subarray(t.length-T);let i=new Uint8Array(0);if(r.length){const t=await k.decrypt(Object.assign({counter:this.counter},x),e.key,r);i=new Uint8Array(t)}let s=!0;if(this.signed){const t=await k.sign(b,e.authentication,this.input.subarray(0,this.input.length-T)),r=new Uint8Array(t);this.input=null;for(let t=0;t<T;t++)r[t]!=n[t]&&(s=!1)}return{valid:s,data:i}}}class z{constructor(t){this.password=t,this.output=new Uint8Array(0),this.pendingInput=new Uint8Array(0)}async append(t){const e=async(i=0)=>{if(i+g<=t.length){const s=t.subarray(i,i+g),a=await k.encrypt(Object.assign({counter:this.counter},x),this.keys.key,s);return L(this.counter),n.set(new Uint8Array(a),i+r.length),e(i+g)}return this.pendingInput=t.subarray(i),this.output=_(this.output,n),n};let r=new Uint8Array(0);this.password&&(r=await async function(t,e){const r=crypto.getRandomValues(new Uint8Array(16));return await C(t,e,r,["encrypt"]),_(r,t.keys.passwordVerification)}(this,this.password),this.password=null);let n=new Uint8Array(r.length+t.length-t.length%g);return n.set(r,0),this.pendingInput.length&&(t=_(this.pendingInput,t),n=W(n,t.length-t.length%g)),e()}async flush(){let t=new Uint8Array(0);if(this.pendingInput.length){const e=await k.encrypt(Object.assign({counter:this.counter},x),this.keys.key,this.pendingInput);t=new Uint8Array(e),this.output=_(this.output,t)}const e=await k.sign(b,this.keys.authentication,this.output.subarray(18));this.output=null;const r=new Uint8Array(e).subarray(0,T);return{data:_(t,r),signature:r}}}async function C(t,e,r,n){t.counter=new Uint8Array(I);const i=(new TextEncoder).encode(e),s=await k.importKey(y,i,A,!1,F),a=await k.deriveBits(Object.assign({salt:r},R),s,528),o=new Uint8Array(a);t.keys={key:await k.importKey(y,o.subarray(0,32),U,!0,n),authentication:await k.importKey(y,o.subarray(32,64),D,!1,S),passwordVerification:o.subarray(64)}}function L(t){for(let e=0;e<16;e++){if(255!=t[e]){t[e]++;break}t[e]=0}}function _(t,e){let r=t;return t.length+e.length&&(r=new Uint8Array(t.length+e.length),r.set(t,0),r.set(e,t.length)),r}function W(t,e){if(e&&e>t.length){const r=t;(t=new Uint8Array(e)).set(r,0)}return t}const B="deflate",M="inflate",N="Invalid signature";class O{constructor(t){this.signature=t.inputSignature,this.encrypted=Boolean(t.inputPassword),this.signed=t.inputSigned,this.compressed=t.inputCompressed,this.inflate=this.compressed&&new t.codecConstructor,this.crc32=this.signed&&this.signed&&new w,this.decrypt=this.encrypted&&new v(t.inputPassword)}async append(t){return this.encrypted&&(t=await this.decrypt.append(t)),this.compressed&&t.length&&(t=await this.inflate.append(t)),!this.encrypted&&this.signed&&this.crc32.append(t),t}async flush(){let t,e=new Uint8Array(0);if(this.encrypted){const t=await this.decrypt.flush();if(!t.valid)throw new Error(N);e=t.data}else if(this.signed){const e=new DataView(new Uint8Array(4).buffer);if(t=this.crc32.get(),e.setUint32(0,t),this.signature!=e.getUint32(0,!1))throw new Error(N)}return this.compressed&&(e=await this.inflate.append(e)||new Uint8Array(0),await this.inflate.flush()),{data:e,signature:t}}}class P{constructor(t){this.encrypted=t.outputEncrypted,this.signed=t.outputSigned,this.compressed=t.outputCompressed,this.deflate=this.compressed&&new t.codecConstructor({level:t.level||5}),this.crc32=this.signed&&new w,this.encrypt=this.encrypted&&new z(t.outputPassword)}async append(t){let e=t;return this.compressed&&t.length&&(e=await this.deflate.append(t)),this.encrypted?e=await this.encrypt.append(e):this.signed&&this.crc32.append(t),e}async flush(){let t,e=new Uint8Array(0);if(this.compressed&&(e=await this.deflate.flush()||new Uint8Array(0)),this.encrypted){e=await this.encrypt.append(e);const r=await this.encrypt.flush();t=r.signature;const n=new Uint8Array(e.length+r.data.length);n.set(e,0),n.set(r.data,e.length),e=n}else this.signed&&(t=this.crc32.get());return{data:e,signature:t}}}const V="init",j="append",H="flush",Z="message";const q={pool:[],pendingRequests:[]};function K(t,e){const r=q.pool,n=!(t.inputCompressed||t.inputSigned||t.inputEncrypted||t.outputCompressed||t.outputSigned||t.outputEncrypted),i=t.useWebWorkers||void 0===t.useWebWorkers&&e.useWebWorkers&&!n;let s;if(i){const r=t.codecType;e.workerScripts?s=e.workerScripts[r]:t.workerScriptsPath=(e.workerScriptsPath||"")+"z-worker.js"}if(r.length<e.maxWorkers){const e={};return r.push(e),Y(e,t,i,s)}{const e=r.find((t=>!t.busy));return e?Y(e,t,i,s):new Promise((e=>q.pendingRequests.push({resolve:e,options:t,webWorker:i,scripts:s})))}}function Y(t,e,r,n){return t.busy=!0,t.options=e,t.scripts=n,t.webWorker=r,r?function(t,e){let r;t.interface||(t.scripts?t.worker=new Worker(new URL(t.scripts[0],"undefined"==typeof document?new(require("url").URL)("file:"+__filename).href:document.currentScript&&document.currentScript.src||new URL("zip-fs.min.js",document.baseURI).href)):t.worker=new Worker(new URL(e.workerScriptsPath,"undefined"==typeof document?new(require("url").URL)("file:"+__filename).href:document.currentScript&&document.currentScript.src||new URL("zip-fs.min.js",document.baseURI).href)),t.worker.addEventListener(Z,s,!1),t.interface={append:t=>n({type:j,data:t}),flush:()=>n({type:H})});return t.interface;async function n(e){if(!r){const e=t.options,r=t.scripts?t.scripts.slice(1):[];await i(Object.assign({scripts:r,type:V,options:{codecType:e.codecType,inputPassword:e.inputPassword,inputSigned:e.inputSigned,inputSignature:e.signature,inputCompressed:e.inputCompressed,inputEncrypted:e.inputEncrypted,level:e.level,outputPassword:e.outputPassword,outputSigned:e.outputSigned,outputCompressed:e.outputCompressed,outputEncrypted:e.outputEncrypted}}))}return i(e)}function i(e){const n=t.worker,i=new Promise(((t,e)=>r={resolve:t,reject:e}));try{if(e.data)try{n.postMessage(e,[e.data.buffer])}catch(t){n.postMessage(e)}else n.postMessage(e)}catch(e){r.reject(e),r=null,X(t)}return i}function s(e){const n=e.data;if(r){const e=n.error;if(e){const n=new Error(e.message);n.stack=e.stack,r.reject(n),r=null,X(t)}else n.type!=V&&n.type!=H&&n.type!=j||(n.type==H?(r.resolve({data:new Uint8Array(n.data),signature:n.signature}),r=null,X(t)):r.resolve(n.data&&new Uint8Array(n.data)))}}}(t,e):function(t){const e=function(t){return t.codecType.startsWith(B)?new P(t):t.codecType.startsWith(M)?new O(t):void 0}(t.options);return{async append(r){try{return await e.append(r)}catch(e){throw X(t),e}},async flush(){try{return await e.flush()}finally{X(t)}}}}(t)}function X(t){if(t.busy=!1,q.pendingRequests.length){const[{resolve:e,options:r,webWorker:n,scripts:i}]=q.pendingRequests.splice(0,1);e(Y(t,r,n,i))}else t.worker&&t.worker.terminate(),q.pool=q.pool.filter((e=>e!=t))}async function G(t,e,r,n,i,s,a){const o=Math.max(s.chunkSize,64);return async function s(c=0,d=0){const h=c*o;if(h<i){const l=await e.readUint8Array(h+n,Math.min(o,i-h)),u=await t.append(l);return d+=await J(r,u),a.onprogress&&a.onprogress(h+l.length,i),s(c+1,d)}{const e=await t.flush();return d+=await J(r,e.data),{signature:e.signature,length:d}}}()}async function J(t,e){return e.length&&await t.writeUint8Array(e),e.length}const Q=["filename","rawFilename","directory","encrypted","compressedSize","uncompressedSize","lastModDate","rawLastModDate","comment","rawComment","signature","extraField","rawExtraField","bitFlag","extraFieldZip64","extraFieldUnicodePath","extraFieldUnicodeComment","extraFieldAES","filenameUTF8","commentUTF8"];class ${constructor(t){Q.forEach((e=>this[e]=t[e]))}}const tt="File format is not recognized",et="End of central directory not found",rt="End of Zip64 central directory not found",nt="End of Zip64 central directory locator not found",it="Central directory header not found",st="Local file header not found",at="Zip64 extra field not found",ot="File contains encrypted entry",ct="Encryption not supported",dt="Compression method not supported",ht="utf-8",lt=["uncompressedSize","compressedSize","offset"];class ut{constructor(t,e,r){this.reader=t,this.config=e,this.options=r}async getData(t,e={}){const r=this.reader;r.initialized||await r.init();const n=await r.readUint8Array(this.offset,30),i=new DataView(n.buffer),a=void 0===e.password?this.options.password:e.password;let o=a&&a.length&&a;if(this.extraFieldAES){if(99!=this.extraFieldAES.originalCompressionMethod)throw new Error(dt);if(3!=this.extraFieldAES.strength)throw new Error(ct)}if(0!=this.compressionMethod&&8!=this.compressionMethod)throw new Error(dt);if(bt(i,0)!=s)throw new Error(st);const c=this.localDirectory={};pt(c,i,4),c.rawExtraField=n.subarray(this.offset+30+c.filenameLength,this.offset+30+c.filenameLength+c.extraFieldLength),wt(this,c,i,4);let d=this.offset+30+c.filenameLength+c.extraFieldLength;const h=this.bitFlag.encrypted&&c.bitFlag.encrypted;if(h&&!o)throw new Error(ot);const l=await K({codecType:M,codecConstructor:this.config.Inflate,inputPassword:o,inputSigned:void 0===e.checkSignature?this.options.checkSignature:e.checkSignature,inputSignature:this.signature,inputCompressed:0!=this.compressionMethod,inputEncrypted:h,useWebWorkers:void 0===e.useWebWorkers?this.options.useWebWorkers:e.useWebWorkers},this.config);return t.initialized||await t.init(),await G(l,r,t,d,this.compressedSize,this.config,{onprogress:e.onprogress}),t.getData()}}function pt(t,e,r){t.version=mt(e,r);const n=t.rawBitFlag=mt(e,r+2);t.bitFlag={encrypted:1==(1&n),level:(6&n)>>1,dataDescriptor:8==(8&n),languageEncodingFlag:(n&u)==u},t.encrypted=t.bitFlag.encrypted,t.rawLastModDate=bt(e,r+6),t.lastModDate=function(t){const e=(4294901760&t)>>16,r=65535&t;try{return new Date(1980+((65024&e)>>9),((480&e)>>5)-1,31&e,(63488&r)>>11,(2016&r)>>5,2*(31&r),0)}catch(t){}}(t.rawLastModDate),t.filenameLength=mt(e,r+22),t.extraFieldLength=mt(e,r+24)}function wt(t,e,r,i){const s=e.rawExtraField,a=e.extraField=new Map,o=new DataView(new Uint8Array(s).buffer);let c=0;try{for(;c<s.length;){const t=mt(o,c),e=mt(o,c+2);a.set(t,{type:t,data:s.slice(c+4,c+4+e)}),c+=4+e}}catch(t){}const d=mt(r,i+4);e.signature=bt(r,i+10),e.uncompressedSize=bt(r,i+18),e.compressedSize=bt(r,i+14);const h=e.extraFieldZip64=a.get(1);h&&function(t,e){e.zip64=!0;const r=new DataView(t.data.buffer);t.values=[];for(let e=0;e<Math.floor(t.data.length/8);e++)t.values.push(Number(Et(r,0+8*e)));const i=lt.filter((t=>e[t]==n));for(let e=0;e<i.length;e++)t[i[e]]=t.values[e];lt.forEach((r=>{if(e[r]==n){if(!t||void 0===t[r])throw new Error(at);e[r]=t[r]}}))}(h,e);const l=e.extraFieldUnicodePath=a.get(28789);l&&ft(l,"filename","rawFilename",e,t);let u=e.extraFieldUnicodeComment=a.get(25461);u&&ft(u,"comment","rawComment",e,t);const p=e.extraFieldAES=a.get(39169);p?function(t,e,r){if(t){const n=new DataView(t.data.buffer);t.vendorVersion=yt(n,0),t.vendorId=yt(n,2);const i=yt(n,4);t.strength=i,t.originalCompressionMethod=r,e.compressionMethod=t.compressionMethod=mt(n,5)}else e.compressionMethod=r}(p,e,d):e.compressionMethod=d,8==e.compressionMethod&&(e.bitFlag.enhancedDeflating=16!=(16&e.rawBitFlag))}function ft(t,e,r,n,i){const s=new DataView(t.data.buffer);t.version=yt(s,0),t.signature=bt(s,1);const a=new w;a.append(i[r]);const o=new DataView(new Uint8Array(4).buffer);o.setUint32(0,a.get(),!0),t[e]=(new TextDecoder).decode(t.data.subarray(5)),t.valid=!i.bitFlag.languageEncodingFlag&&t.signature==bt(o,0),t.valid&&(n[e]=t[e],n[e+"UTF8"]=!0)}function gt(t,e){return e&&"cp437"!=e.trim().toLowerCase()?new TextDecoder(e).decode(t):(t=>{let e="";for(let r=0;r<t.length;r++)e+=p[t[r]];return e})(t)}function yt(t,e){return t.getUint8(e)}function mt(t,e){return t.getUint16(e,!0)}function bt(t,e){return t.getUint32(e,!0)}function Et(t,e){return t.getBigUint64(e,!0)}const Ut="HTTP error ",At="HTTP Range not supported",Rt="text/plain";class Dt{constructor(){this.size=0}init(){this.initialized=!0}}class xt extends Dt{}class Ft extends Dt{writeUint8Array(t){this.size+=t.length}}class St extends xt{constructor(t){super(),this.blobReader=new vt(new Blob([t],{type:Rt}))}init(){super.init(),this.blobReader.init(),this.size=this.blobReader.size}readUint8Array(t,e){return this.blobReader.readUint8Array(t,e)}}class Tt extends Ft{constructor(t){super(),this.encoding=t,this.blob=new Blob([],{type:Rt})}writeUint8Array(t){super.writeUint8Array(t),this.blob=new Blob([this.blob,t.buffer],{type:Rt})}getData(){const t=new FileReader;return new Promise(((e,r)=>{t.onload=t=>e(t.target.result),t.onerror=r,t.readAsText(this.blob,this.encoding)}))}}class It extends xt{constructor(t){super(),this.dataURI=t;let e=t.length;for(;"="==t.charAt(e-1);)e--;this.dataStart=t.indexOf(",")+1,this.size=Math.floor(.75*(e-this.dataStart))}readUint8Array(t,e){const r=new Uint8Array(e),n=4*Math.floor(t/3),i=atob(this.dataURI.substring(n+this.dataStart,4*Math.ceil((t+e)/3)+this.dataStart)),s=t-3*Math.floor(n/4);for(let t=s;t<s+e;t++)r[t-s]=i.charCodeAt(t);return r}}class kt extends Ft{constructor(t){super(),this.data="data:"+(t||"")+";base64,",this.pending=[]}writeUint8Array(t){super.writeUint8Array(t);let e=0,r=this.pending;const n=this.pending.length;for(this.pending="",e=0;e<3*Math.floor((n+t.length)/3)-n;e++)r+=String.fromCharCode(t[e]);for(;e<t.length;e++)this.pending+=String.fromCharCode(t[e]);r.length>2?this.data+=btoa(r):this.pending=r}getData(){return this.data+btoa(this.pending)}}class vt extends xt{constructor(t){super(),this.blob=t,this.size=t.size}readUint8Array(t,e){const r=new FileReader;return new Promise(((n,i)=>{r.onload=t=>n(new Uint8Array(t.target.result)),r.onerror=i,r.readAsArrayBuffer(this.blob.slice(t,t+e))}))}}class zt extends Ft{constructor(t){super(),this.offset=0,this.contentType=t,this.blob=new Blob([],{type:t})}writeUint8Array(t){super.writeUint8Array(t),this.blob=new Blob([this.blob,t.buffer],{type:this.contentType}),this.offset=this.blob.size}getData(){return this.blob}}class Ct extends xt{constructor(t){super(),this.url=t}async init(){if(super.init(),function(t){if("undefined"!=typeof document){const e=document.createElement("a");return e.href=t,"http:"==e.protocol||"https:"==e.protocol}return/^https?:\/\//i.test(t)}(this.url))return new Promise(((t,e)=>{const r=new XMLHttpRequest;r.addEventListener("load",(()=>{r.status<400?(this.size=Number(r.getResponseHeader("Content-Length")),this.size?t():Wt().then((()=>t())).catch(e)):e(Ut+(r.statusText||r.status)+".")}),!1),r.addEventListener("error",e,!1),r.open("HEAD",this.url),r.send()}));await Wt()}async readUint8Array(t,e){return this.data||await Wt(this,this.url),new Uint8Array(this.data.subarray(t,t+e))}}class Lt extends xt{constructor(t){super(),this.url=t}init(){return super.init(),new Promise(((t,e)=>{const r=new XMLHttpRequest;r.addEventListener("load",(()=>{r.status<400?(this.size=Number(r.getResponseHeader("Content-Length")),"bytes"==r.getResponseHeader("Accept-Ranges")?t():e(new Error(At))):e(Ut+(r.statusText||r.status)+".")}),!1),r.addEventListener("error",e,!1),r.open("HEAD",this.url),r.send()}))}readUint8Array(t,e){return new Promise(((r,n)=>{const i=new XMLHttpRequest;i.open("GET",this.url),i.responseType="arraybuffer",i.setRequestHeader("Range","bytes="+t+"-"+(t+e-1)),i.addEventListener("load",(()=>{i.status<400?r(new Uint8Array(i.response)):n(Ut+(i.statusText||i.status)+".")}),!1),i.addEventListener("error",n,!1),i.send()}))}}class _t extends Ft{constructor(){super(),this.array=new Uint8Array(0)}writeUint8Array(t){super.writeUint8Array(t);const e=this.array;this.array=new Uint8Array(e.length+t.length),this.array.set(e),this.array.set(t,e.length)}getData(){return this.array}}function Wt(t,e){return new Promise(((r,n)=>{const i=new XMLHttpRequest;i.addEventListener("load",(()=>{i.status<400?(t.size||(t.size=Number(i.getResponseHeader("Content-Length"))||Number(i.response.byteLength)),t.data=new Uint8Array(i.response),r()):n(Ut+(i.statusText||i.status)+".")}),!1),i.addEventListener("error",n,!1),i.open("GET",e),i.responseType="arraybuffer",i.send()}))}const Bt="File already exists",Mt="Zip file comment exceeds 64KB",Nt="File entry comment exceeds 64KB",Ot="File entry name exceeds 64KB",Pt="Version exceeds 65535",Vt="The minimum year for the date is 1980",jt="Extra field type exceeds 65535",Ht="Extra field data exceeds 64KB",Zt=new Uint8Array([7,0,2,0,65,69,3,0,0]);function qt(t,e,r){t.setUint8(e,r)}function Kt(t,e,r){t.setUint16(e,r,!0)}function Yt(t,e,r){t.setUint32(e,r,!0)}function Xt(t,e,r){t.setBigUint64(e,r,!0)}const Gt={chunkSize:524288,maxWorkers:"undefined"!=typeof navigator&&navigator.hardwareConcurrency||2,workerScriptsPath:void 0,useWebWorkers:!0};let Jt=Object.assign({},Gt);class Qt extends class{constructor(t,e={},r={}){this.reader=t,this.options=e,this.config=r}async getEntries(t={}){const e=this.reader;if(e.initialized||await e.init(),e.size<22)throw new Error(tt);const r=await async function(t,e,r,n){const i=new Uint8Array(4);!function(t,e,r){t.setUint32(e,r,!0)}(new DataView(i.buffer),0,e);const s=r+n;let a=r,o=await c(a);o||(o=await c(Math.min(s,t.size)));return o;async function c(e){const n=t.size-e,s=await t.readUint8Array(n,e);for(let t=s.length-r;t>=0;t--)if(s[t]==i[0]&&s[t+1]==i[1]&&s[t+2]==i[2]&&s[t+3]==i[3])return{offset:n,buffer:s.slice(t,t+r).buffer}}}(e,c,22,i);if(!r)throw new Error(et);const s=new DataView(r.buffer);let a,l=bt(s,16),u=mt(s,8);if(l==n||u==i){a=!0;const t=await e.readUint8Array(r.offset-20,20),n=new DataView(t.buffer);if(Number(bt(n,0))!=h)throw new Error(rt);l=Number(Et(n,8));const i=await e.readUint8Array(l,56),s=new DataView(i.buffer);if(Number(bt(s,0))!=d)throw new Error(nt);u=Number(Et(s,24)),l-=Number(Et(s,40))}if(l<0||!a&&(l>=e.size||u>=i))throw new Error(tt);const p=await e.readUint8Array(l,e.size-l),w=new DataView(p.buffer),f=[];let g=0;for(let e=0;e<u;e++){const e=new ut(this.reader,this.config,this.options);if(bt(w,g)!=o)throw new Error(it);e.compressedSize=0,e.uncompressedSize=0,pt(e,w,g+6),e.commentLength=mt(w,g+32),e.directory=16==(16&yt(w,g+38)),e.offset=bt(w,g+42),e.rawFilename=p.subarray(g+46,g+46+e.filenameLength);const r=void 0===t.filenameEncoding?this.options.filenameEncoding:t.filenameEncoding;e.filenameUTF8=e.commentUTF8=Boolean(e.bitFlag.languageEncodingFlag),e.filename=gt(e.rawFilename,e.filenameUTF8?ht:r),!e.directory&&e.filename&&"/"==e.filename.charAt(e.filename.length-1)&&(e.directory=!0),e.rawExtraField=p.subarray(g+46+e.filenameLength,g+46+e.filenameLength+e.extraFieldLength),e.rawComment=p.subarray(g+46+e.filenameLength+e.extraFieldLength,g+46+e.filenameLength+e.extraFieldLength+e.commentLength);const n=void 0===t.commentEncoding?this.options.commentEncoding:t.commentEncoding;e.comment=gt(e.rawComment,e.commentUTF8?ht:n),wt(e,e,w,g+6);const i=new $(e);i.getData=(t,r)=>e.getData(t,r),f.push(i),g+=46+e.filenameLength+e.extraFieldLength+e.commentLength}return f}async close(){}}{constructor(t,e){super(t,e,Jt)}}class $t extends class{constructor(t,e={},r={}){this.writer=t,this.options=e,this.config=r,this.files=new Map,this.offset=t.size}async add(t="",e,r={}){if(t=t.trim(),!r.directory||t.length&&"/"==t.charAt(t.length-1)||(t+="/"),this.files.has(t))throw new Error(Bt);const o=(new TextEncoder).encode(t);if(o.length>i)throw new Error(Ot);const c=r.comment||"",d=(new TextEncoder).encode(c);if(d.length>i)throw new Error(Nt);const h=this.options.version||r.version||0;if(h>i)throw new Error(Pt);const u=r.lastModDate||new Date;if(u.getFullYear()<1980)throw new Error(Vt);e&&!e.initialized&&await e.init();let p=new Uint8Array(0);const w=r.extraField;if(w){let t=4,e=0;w.forEach((e=>t+=e.length)),p=new Uint8Array(t),w.forEach(((t,r)=>{if(r>i)throw new Error(jt);if(t.length>i)throw new Error(Ht);p.set(new Uint16Array([r]),e),p.set(new Uint16Array([t.length]),e+2),p.set(t,e+4),e+=4+t.length}))}const f=r.zip64||this.options.zip64||this.offset>=n||e&&(e.size>=n||this.offset+e.size>=n),g=void 0===r.password?this.options.password:r.password,y=void 0===r.level?this.options.level:r.level,m=void 0===r.useWebWorkers?this.options.useWebWorkers:r.useWebWorkers,b=await async function(t,e,r,i){const o=t.files,c=t.writer;let d;o.set(e,null);try{let h,u;try{i.bufferedWrite||t.options.bufferedWrite||t.lockWrite?(h=new _t,h.init()):(t.lockWrite=new Promise((t=>d=t)),c.initialized||await c.init(),h=c),u=await async function(t,e,r,i){const o=i.rawFilename,c=i.lastModDate,d=i.password,h=Boolean(d&&d.length),u=i.level,p=0!==u&&!i.directory,w=i.zip64;let f;if(h){f=new Uint8Array(Zt.length+2);Kt(new DataView(f.buffer),0,l),f.set(Zt,2)}else f=new Uint8Array(0);const g={version:i.version||20,zip64:w,directory:Boolean(i.directory),filenameUTF8:!0,rawFilename:o,commentUTF8:!0,rawComment:i.rawComment,rawExtraFieldZip64:w?new Uint8Array(28):new Uint8Array(0),rawExtraFieldAES:f,rawExtraField:i.rawExtraField};let y=2056,m=0;p&&(m=8);w&&(g.version=g.version>45?g.version:45);h&&(g.version=g.version>51?g.version:51,y|=1,m=99,p&&(g.rawExtraFieldAES[9]=8));const b=g.headerArray=new Uint8Array(26),E=new DataView(b.buffer);Kt(E,0,g.version),Kt(E,2,y),Kt(E,4,m),Kt(E,6,(c.getHours()<<6|c.getMinutes())<<5|c.getSeconds()/2),Kt(E,8,(c.getFullYear()-1980<<4|c.getMonth()+1)<<5|c.getDate()),Kt(E,22,o.length),Kt(E,24,0);const U=E.getUint32(6,!0),A=new Uint8Array(30+o.length);Yt(new DataView(A.buffer),0,s),A.set(b,4),A.set(o,30);let R,D=0,x=0;if(t){D=t.size;const n=await K({codecType:B,codecConstructor:r.Deflate,level:u,outputPassword:d,outputSigned:!0,outputCompressed:p,outputEncrypted:h,useWebWorkers:i.useWebWorkers},r);await e.writeUint8Array(A),R=await G(n,t,e,0,D,r,{onprogress:i.onprogress}),x=R.length}else await e.writeUint8Array(A);const F=new Uint8Array(w?24:16),S=new DataView(F.buffer);if(Yt(S,0,a),t)if(h||void 0===R.signature||(Yt(E,10,R.signature),Yt(S,4,R.signature),g.signature=R.signature),w){const t=new DataView(g.rawExtraFieldZip64.buffer);Kt(t,0,1),Kt(t,2,24),Yt(E,14,n),Xt(S,8,BigInt(x)),Xt(t,12,BigInt(x)),Yt(E,18,n),Xt(S,16,BigInt(D)),Xt(t,4,BigInt(D))}else Yt(E,14,x),Yt(S,8,x),Yt(E,18,D),Yt(S,12,D);return await e.writeUint8Array(F),g.compressedSize=x,g.uncompressedSize=D,g.lastModDate=c,g.rawLastModDate=U,g.encrypted=h,g.length=A.length+(R?R.length:0)+F.length,g}(r,h,t.config,i)}catch(t){throw o.delete(e),t}if(o.set(e,u),h!=c&&(t.lockWrite&&await t.lockWrite,await c.writeUint8Array(h.getData())),u.offset=t.offset,u.zip64){Xt(new DataView(u.rawExtraFieldZip64.buffer),20,BigInt(u.offset))}return t.offset+=u.length,u}finally{d&&(t.lockWrite=null,d())}}(this,t,e,Object.assign({},r,{rawFilename:o,rawComment:d,version:h,lastModDate:u,rawExtraField:p,zip64:f,password:g,level:y,useWebWorkers:m}));return b.filename=t,b.comment=c,b.extraField=w,new $(b)}async close(t=new Uint8Array(0)){const e=this.writer,r=this.files;let s=0,a=0,l=this.offset,u=r.size;if(t.length){if(!(t.length<=i))throw new Error(Mt);Kt(f,s+20,t.length)}for(const[,t]of r)a+=46+t.rawFilename.length+t.rawComment.length+t.rawExtraFieldZip64.length+t.rawExtraFieldAES.length+t.rawExtraField.length;const p=this.options.zip64||l+a>=n||u>=i,w=new Uint8Array(a+(p?98:22)),f=new DataView(w.buffer);for(const[,t]of r){const e=t.rawFilename,r=t.rawExtraFieldZip64,i=t.rawExtraFieldAES,a=r.length+i.length+t.rawExtraField.length;Yt(f,s,o),Kt(f,s+4,t.version),w.set(t.headerArray,s+6),Kt(f,s+30,a),Kt(f,s+32,t.rawComment.length),t.directory&&qt(f,s+38,16),t.zip64?Yt(f,s+42,n):Yt(f,s+42,t.offset),w.set(e,s+46),w.set(r,s+46+e.length),w.set(i,s+46+e.length+r.length),w.set(t.rawExtraField,46+e.length+r.length+i.length),w.set(t.rawComment,s+46+e.length+a),s+=46+e.length+a+t.rawComment.length}return p&&(Yt(f,s,d),Xt(f,s+4,BigInt(44)),Kt(f,s+12,45),Kt(f,s+14,45),Xt(f,s+24,BigInt(u)),Xt(f,s+32,BigInt(u)),Xt(f,s+40,BigInt(a)),Xt(f,s+48,BigInt(l)),Yt(f,s+56,h),Xt(f,s+64,BigInt(l+a)),Yt(f,s+72,1),u=i,l=n,s+=76),Yt(f,s,c),Kt(f,s+8,u),Kt(f,s+10,u),Yt(f,s+12,a),Yt(f,s+16,l),await e.writeUint8Array(w),await e.writeUint8Array(t),e.getData()}}{constructor(t,e){super(t,e,Jt)}}const te=524288;class ee{constructor(t,e,r,n){if(t.root&&n&&n.getChildByName(e))throw new Error("Entry filename already exists");r||(r={}),this.fs=t,this.name=e,this.data=r.data,this.id=t.entries.length,this.parent=n,this.children=[],this.uncompressedSize=0,t.entries.push(this),n&&this.parent.children.push(this)}moveTo(t){if(!t.directory)throw new Error("Target entry is not a directory");if(t.isDescendantOf(this))throw new Error("Entry is a ancestor of target entry");if(this!=t){if(t.getChildByName(this.name))throw new Error("Entry filename already exists");oe(this),this.parent=t,t.children.push(this)}}getFullname(){let t=this.name,e=this.parent;for(;e;)t=(e.name?e.name+"/":"")+t,e=e.parent;return t}isDescendantOf(t){let e=this.parent;for(;e&&e.id!=t.id;)e=e.parent;return Boolean(e)}}class re extends ee{constructor(t,e,r,n){super(t,e,r,n),this.Reader=r.Reader,this.Writer=r.Writer,r.getData&&(this.getData=r.getData)}async getData(t,e={}){return!t||t.constructor==this.Writer&&this.data?this.data:(this.reader=new this.Reader(this.data,e),await this.reader.init(),await t.init(),this.uncompressedSize=this.reader.size,async function(t,e){return r();async function r(n=0){const i=n*te;if(i<t.size){const s=await t.readUint8Array(i,Math.min(te,t.size-i));return await e.writeUint8Array(s),r(n+1)}return e.getData()}}(this.reader,t))}getText(t,e){return this.getData(new Tt(t),e)}getBlob(t,e){return this.getData(new zt(t),e)}getData64URI(t,e){return this.getData(new kt(t),e)}replaceBlob(t){this.data=t,this.Reader=vt,this.reader=null}replaceText(t){this.data=t,this.Reader=St,this.reader=null}}class ne extends ee{constructor(t,e,r,n){super(t,e,r,n),this.directory=!0}addDirectory(t){return de(this,t,null,!0)}addText(t,e){return de(this,t,{data:e,Reader:St,Writer:Tt})}addBlob(t,e){return de(this,t,{data:e,Reader:vt,Writer:zt})}addData64URI(t,e){return de(this,t,{data:e,Reader:It,Writer:kt})}addHttpContent(t,e,r={}){return de(this,t,{data:e,Reader:r.useRangeHeader?Lt:Ct})}addFileEntry(t){!async function(t,e){e.isDirectory?await n(t,e):await new Promise(((r,n)=>{e.file((n=>{t.addBlob(e.name,n),r()}),n)}));function r(t){return new Promise(((e,r)=>{let n=[];function i(t){t.readEntries((r=>{r.length?(n=n.concat(r),i(t)):e(n)}),r)}t.isDirectory&&i(t.createReader()),t.isFile&&e(n)}))}async function n(t,e){const i=await r(e);for(const e of i)e.isDirectory&&await n(t.addDirectory(e.name)),await new Promise(((r,n)=>{e.isFile&&e.file((n=>{const i=t.addBlob(e.name,n);i.uncompressedSize=n.size,r(i)}),n)}))}}(this,t)}async addData(t,e){return de(this,t,e)}async importBlob(t,e={}){await this.importZip(new vt(t),e)}async importData64URI(t,e={}){await this.importZip(new It(t),e)}async importHttpContent(t,e={}){await this.importZip(e.useRangeHeader?new Lt(t):new Ct(t),e)}async exportBlob(t={}){return this.exportZip(new zt("application/zip"),t)}async exportData64URI(t={}){return this.exportZip(new kt("application/zip"),t)}async importZip(t,e){await t.init();const r=new Qt(t,e);(await r.getEntries()).forEach((t=>{let r=this,n=t.filename.split("/"),i=n.pop();n.forEach((t=>r=r.getChildByName(t)||new ne(this.fs,t,null,r))),t.directory||de(r,i,{data:t,Reader:se(Object.assign({},e))})}))}async exportZip(t,e){await ae(this);const r=new $t(t,e);return await async function(t,e,r,n){const i=new Map;async function s(t,e){async function a(){if(n.bufferedWrite)await Promise.all(e.children.map(o));else for(const t of e.children)await o(t)}async function o(e){await t.add(e.getFullname(),e.reader,Object.assign({directory:e.directory},Object.assign({},n,{onprogress:t=>{n.onprogress&&(i.set(e.getFullname(),t),n.onprogress(Array.from(i.values()).reduce(((t,e)=>t+e)),r))}}))),await s(t,e)}await a()}await s(t,e)}(r,this,function(t,e){let r=0;return t.forEach(n),r;function n(t){r+=t[e],t.children&&t.children.forEach(n)}}([this],"uncompressedSize"),e),await r.close(),t.getData()}getChildByName(t){for(let e=0;e<this.children.length;e++){const r=this.children[e];if(r.name==t)return r}}}const ie={FS:class{constructor(){ce(this)}remove(t){oe(t),this.entries[t.id]=null}find(t){const e=t.split("/");let r=this.root;for(let t=0;r&&t<e.length;t++)r=r.getChildByName(e[t]);return r}getById(t){return this.entries[t]}async importBlob(t,e){ce(this),await this.root.importBlob(t,e)}async importData64URI(t,e){ce(this),await this.root.importData64URI(t,e)}async importHttpContent(t,e){this.entries=[],this.root=new ne(this),await this.root.importHttpContent(t,e)}async exportBlob(t){return this.root.exportBlob(t)}async exportData64URI(t){return this.root.exportData64URI(t)}},ZipDirectoryEntry:ne,ZipFileEntry:re};function se(t){return class extends xt{constructor(t,e={}){super(),this.entry=t,this.options=e}async readUint8Array(e,r){if(!this.blobReader){const e=await this.entry.getData(new zt,Object.assign({},this.options,t));this.data=e,this.blobReader=new vt(e)}return this.blobReader.readUint8Array(e,r)}async init(){this.size=this.entry.uncompressedSize}}}async function ae(t){if(t.children.length)for(const e of t.children)e.directory?await ae(e):(e.reader=new e.Reader(e.data),await e.reader.init(),e.uncompressedSize=e.reader.size)}function oe(t){const e=t.parent.children;e.forEach(((r,n)=>{r.id==t.id&&e.splice(n,1)}))}function ce(t){t.entries=[],t.root=new ne(t)}function de(t,e,r,n){if(t.directory)return n?new ne(t.fs,e,r,t):new re(t.fs,e,r,t);throw new Error("Parent entry is not a directory")}t.BlobReader=vt,t.BlobWriter=zt,t.Data64URIReader=It,t.Data64URIWriter=kt,t.ERR_BAD_FORMAT=tt,t.ERR_CENTRAL_DIRECTORY_NOT_FOUND=it,t.ERR_DUPLICATED_NAME=Bt,t.ERR_ENCRYPTED=ot,t.ERR_EOCDR_LOCATOR_ZIP64_NOT_FOUND=nt,t.ERR_EOCDR_NOT_FOUND=et,t.ERR_EOCDR_ZIP64_NOT_FOUND=rt,t.ERR_EXTRAFIELD_ZIP64_NOT_FOUND=at,t.ERR_HTTP_RANGE=At,t.ERR_INVALID_COMMENT=Mt,t.ERR_INVALID_DATE=Vt,t.ERR_INVALID_ENTRY_COMMENT=Nt,t.ERR_INVALID_ENTRY_NAME=Ot,t.ERR_INVALID_EXTRAFIELD_DATA=Ht,t.ERR_INVALID_EXTRAFIELD_TYPE=jt,t.ERR_INVALID_PASSWORD=f,t.ERR_INVALID_SIGNATURE=N,t.ERR_INVALID_VERSION=Pt,t.ERR_LOCAL_FILE_HEADER_NOT_FOUND=st,t.ERR_UNSUPPORTED_COMPRESSION=dt,t.ERR_UNSUPPORTED_ENCRYPTION=ct,t.HttpRangeReader=Lt,t.HttpReader=Ct,t.Reader=xt,t.TextReader=St,t.TextWriter=Tt,t.Uint8ArrayReader=class extends xt{constructor(t){super(),this.array=t,this.size=t.length}readUint8Array(t,e){return this.array.slice(t,t+e)}},t.Uint8ArrayWriter=_t,t.Writer=Ft,t.ZipReader=Qt,t.ZipWriter=$t,t.configure=function(t){if(Jt=Object.assign({},Jt,t),null!=Jt.workerScripts&&null!=Jt.workerScriptsPath)throw new Error("Either workerScripts or workerScriptsPath may be set, not both");if(Jt.workerScripts){if(Jt.workerScripts.deflate&&!Array.isArray(Jt.workerScripts.deflate))throw new Error("workerScripts.deflate must be an array");if(Jt.workerScripts.inflate&&!Array.isArray(Jt.workerScripts.inflate))throw new Error("workerScripts.inflate must be an array")}},t.fs=ie,t.getMimeType=function(){return"application/octet-stream"},t.initShimAsyncCodec=(t,e={})=>({Deflate:r(t.Deflate,e.deflate),Inflate:r(t.Inflate,e.inflate)}),Object.defineProperty(t,"__esModule",{value:!0})}));
