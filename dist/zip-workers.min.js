!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).zip={})}(this,(function(t){"use strict";const e="function";function n(t,n){return class{constructor(r){const i=t=>{if(this.pendingData){const e=this.pendingData;this.pendingData=new Uint8Array(e.length+t.length),this.pendingData.set(e,0),this.pendingData.set(t,e.length)}else this.pendingData=new Uint8Array(t)};if(this.codec=new t(Object.assign({},n,r)),typeof this.codec.onData==e)this.codec.onData=i;else{if(typeof this.codec.on!=e)throw new Error("Cannot register the callback function");this.codec.on("data",i)}}async append(t){return this.codec.push(t),r(this)}async flush(){return this.codec.push(new Uint8Array(0),!0),r(this)}};function r(t){if(t.pendingData){const e=t.pendingData;return t.pendingData=null,e}return new Uint8Array(0)}}const r=4294967295,i=65535,s=67324752,a=134695760,o=33639248,c=101010256,d=101075792,h=117853008,l=39169,u=2048;class p{constructor(){this.crc=-1,this.table=(()=>{const t=[];for(let e=0;e<256;e++){let n=e;for(let t=0;t<8;t++)1&n?n=n>>>1^3988292384:n>>>=1;t[e]=n}return t})()}append(t){const e=this.table;let n=0|this.crc;for(let r=0,i=0|t.length;r<i;r++)n=n>>>8^e[255&(n^t[r])];this.crc=n}get(){return~this.crc}}const w="Invalid pasword",f=16,g="raw",y={name:"PBKDF2"},m={name:"HMAC"},b="SHA-1",E={name:"AES-CTR"},A=Object.assign({hash:m},y),U=Object.assign({iterations:1e3,hash:{name:b}},y),R=Object.assign({hash:b},m),D=Object.assign({length:f},E),x=["deriveBits"],F=["sign"],v=528,S=10,I=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],T=crypto.subtle;class k{constructor(t,e){this.password=t,this.signed=e,this.input=e&&new Uint8Array(0),this.pendingInput=new Uint8Array(0)}async append(t){const e=async(i=0)=>{if(i+f<=r.length-S){const t=r.subarray(i,i+f),s=await T.decrypt(Object.assign({counter:this.counter},D),this.keys.decrypt,t);return _(this.counter),n.set(new Uint8Array(s),i),e(i+f)}return this.pendingInput=r.subarray(i),this.signed&&(this.input=C(this.input,t)),n};if(this.password){const e=t.subarray(0,18);await async function(t,e,n){t.counter=new Uint8Array(I);const r=e.subarray(0,16),i=e.subarray(16),s=(new TextEncoder).encode(n),a=await T.importKey(g,s,A,!1,x),o=await T.deriveBits(Object.assign({salt:r},U),a,528),c=new Uint8Array(o),d=c.subarray(64);if(t.keys={decrypt:await T.importKey(g,c.subarray(0,32),E,!0,["decrypt"]),authentication:await T.importKey(g,c.subarray(32,64),R,!1,F),passwordVerification:d},d[0]!=i[0]||d[1]!=i[1])throw new Error(w)}(this,e,this.password),this.password=null,t=t.subarray(18)}let n=new Uint8Array(t.length-S-(t.length-S)%f),r=t;return this.pendingInput.length&&(r=C(this.pendingInput,t),n=z(n,r.length-S-(r.length-S)%f)),e()}async flush(){const t=this.pendingInput,e=this.keys,n=t.subarray(0,t.length-S),r=t.subarray(t.length-S);let i=new Uint8Array(0);if(n.length){const t=await T.decrypt(Object.assign({counter:this.counter},D),e.decrypt,n);i=new Uint8Array(t)}let s=!0;if(this.signed){const t=await T.sign(m,e.authentication,this.input.subarray(0,this.input.length-S)),n=new Uint8Array(t);this.input=null;for(let t=0;t<S;t++)n[t]!=r[t]&&(s=!1)}return{valid:s,data:i}}}class L{constructor(t){this.password=t,this.output=new Uint8Array(0),this.pendingInput=new Uint8Array(0)}async append(t){const e=async(i=0)=>{if(i+f<=t.length){const s=t.subarray(i,i+f),a=await T.encrypt(Object.assign({counter:this.counter},D),this.keys.encrypt,s);return _(this.counter),r.set(new Uint8Array(a),i+n.length),e(i+f)}return this.pendingInput=t.subarray(i),this.output=C(this.output,r),r};let n=new Uint8Array(0);this.password&&(n=await async function(t,e){t.counter=new Uint8Array(I);const n=crypto.getRandomValues(new Uint8Array(16)),r=(new TextEncoder).encode(e),i=await T.importKey(g,r,A,!1,x),s=await T.deriveBits(Object.assign({salt:n},U),i,v),a=new Uint8Array(s);return t.keys={encrypt:await T.importKey(g,a.subarray(0,32),E,!0,["encrypt"]),authentication:await T.importKey(g,a.subarray(32,64),R,!1,F),passwordVerification:a.subarray(64)},C(n,t.keys.passwordVerification)}(this,this.password),this.password=null);let r=new Uint8Array(n.length+t.length-t.length%f);return r.set(n,0),this.pendingInput.length&&(t=C(this.pendingInput,t),r=z(r,t.length-t.length%f)),e()}async flush(){let t=new Uint8Array(0);if(this.pendingInput.length){const e=await T.encrypt(Object.assign({counter:this.counter},D),this.keys.encrypt,this.pendingInput);t=new Uint8Array(e),this.output=C(this.output,t)}const e=await T.sign(m,this.keys.authentication,this.output.subarray(18));this.output=null;const n=new Uint8Array(e).subarray(0,S);return{data:C(t,n),signature:n}}}function _(t){for(let e=0;e<16;e++){if(255!=t[e]){t[e]++;break}t[e]=0}}function C(t,e){let n=t;return t.length+e.length&&(n=new Uint8Array(t.length+e.length),n.set(t,0),n.set(e,t.length)),n}function z(t,e){if(e&&e>t.length){const n=t;(t=new Uint8Array(e)).set(n,0)}return t}const M="deflate",N="inflate",O="Invalid signature";class W{constructor(t){this.signature=t.inputSignature,this.encrypted=Boolean(t.inputPassword),this.signed=t.inputSigned,this.compressed=t.inputCompressed,this.inflate=this.compressed&&new t.codecConstructor,this.crc32=this.signed&&this.signed&&new p,this.decrypt=this.encrypted&&new k(t.inputPassword)}async append(t){return this.encrypted&&(t=await this.decrypt.append(t)),this.compressed&&t.length&&(t=await this.inflate.append(t)),!this.encrypted&&this.signed&&this.crc32.append(t),t}async flush(){let t,e=new Uint8Array(0);if(this.encrypted){const t=await this.decrypt.flush();if(!t.valid)throw new Error(O);e=t.data}else if(this.signed){const e=new DataView(new Uint8Array(4).buffer);if(t=this.crc32.get(),e.setUint32(0,t),this.signature!=e.getUint32(0,!1))throw new Error(O)}return this.compressed&&(e=await this.inflate.append(e)||new Uint8Array(0),await this.inflate.flush()),{data:e,signature:t}}}class P{constructor(t){this.encrypted=t.outputEncrypted,this.signed=t.outputSigned,this.compressed=t.outputCompressed,this.deflate=this.compressed&&new t.codecConstructor({level:t.level||5}),this.crc32=this.signed&&new p,this.encrypt=this.encrypted&&new L(t.outputPassword)}async append(t){let e=t;return this.compressed&&t.length&&(e=await this.deflate.append(t)),this.encrypted?e=await this.encrypt.append(e):this.signed&&this.crc32.append(t),e}async flush(){let t,e=new Uint8Array(0);if(this.compressed&&(e=await this.deflate.flush()||new Uint8Array(0)),this.encrypted){e=await this.encrypt.append(e);const n=await this.encrypt.flush();t=n.signature;const r=new Uint8Array(e.length+n.data.length);r.set(e,0),r.set(n.data,e.length),e=r}else this.signed&&(t=this.crc32.get());return{data:e,signature:t}}}const V="init",B="append",j="flush",H="message",Z="z-worker.js",K={deflate:[Z],inflate:[Z]},q={pool:[],pendingRequests:[]};function Y(t,e){const n=q.pool,r=!(e.inputCompressed||e.inputSigned||e.inputEncrypted||e.outputCompressed||e.outputSigned||e.outputEncrypted);let i;if(e.useWebWorkers||void 0===e.useWebWorkers&&t.useWebWorkers&&!r){const n=e.codecType;t.workerScripts?(s=t.workerScripts[n],i="undefined"!=typeof document?s.map((t=>new URL(t,document.baseURI).href)):s):(i=K[n].slice(0),i[0]=(t.workerScriptsPath||"")+i[0])}var s;if(n.length<t.maxWorkers){const t={};return n.push(t),X(t,e,i)}{const t=n.find((t=>!t.busy));return t?X(t,e,i):new Promise((t=>q.pendingRequests.push({resolve:t,options:e,scripts:i})))}}function X(t,e,n){return t.busy=!0,t.options=e,t.scripts=n,n?function(t){let e;t.interface||(t.worker=new Worker(t.scripts[0]),t.worker.addEventListener(H,i,!1),t.interface={append:t=>n({type:B,data:t}),flush:()=>n({type:j})});return t.interface;async function n(n){if(!e){const e=t.options,n=t.scripts.slice(1);await r(Object.assign({scripts:n,type:V,options:{codecType:e.codecType,inputPassword:e.inputPassword,inputSigned:e.inputSigned,inputSignature:e.signature,inputCompressed:e.inputCompressed,inputEncrypted:e.inputEncrypted,level:e.level,outputPassword:e.outputPassword,outputSigned:e.outputSigned,outputCompressed:e.outputCompressed,outputEncrypted:e.outputEncrypted}}))}return r(n)}function r(n){const r=t.worker,i=new Promise(((t,n)=>e={resolve:t,reject:n}));try{if(n.data)try{r.postMessage(n,[n.data.buffer])}catch(t){r.postMessage(n)}else r.postMessage(n)}catch(n){e.reject(n),e=null,G(t)}return i}function i(n){const r=n.data;if(e){const n=r.error;if(n){const r=new Error(n.message);r.stack=n.stack,e.reject(r),e=null,G(t)}else r.type!=V&&r.type!=j&&r.type!=B||(r.type==j?(e.resolve({data:new Uint8Array(r.data),signature:r.signature}),e=null,G(t)):e.resolve(r.data&&new Uint8Array(r.data)))}}}(t):function(t){const e=function(t){return t.codecType.startsWith(M)?new P(t):t.codecType.startsWith(N)?new W(t):void 0}(t.options);return{async append(n){try{return await e.append(n)}catch(e){throw G(t),e}},async flush(){try{return await e.flush()}finally{G(t)}}}}(t)}function G(t){if(t.busy=!1,q.pendingRequests.length){const[{resolve:e,options:n,scripts:r}]=q.pendingRequests.splice(0,1);e(X(t,n,r))}else t.worker&&t.worker.terminate(),q.pool=q.pool.filter((e=>e!=t))}async function J(t,e,n,r,i,s,a){const o=Math.max(s.chunkSize,64);return async function s(c=0,d=0){const h=c*o;if(h<i){const l=await e.readUint8Array(h+r,Math.min(o,i-h)),u=await t.append(l);return d+=await Q(n,u),a.onprogress&&a.onprogress(h+l.length,i),s(c+1,d)}{const e=await t.flush();return d+=await Q(n,e.data),{signature:e.signature,length:d}}}()}async function Q(t,e){return e.length&&await t.writeUint8Array(e),e.length}const $="File format is not recognized",tt="End of central directory not found",et="End of Zip64 central directory not found",nt="End of Zip64 central directory locator not found",rt="Central directory header not found",it="Local file header not found",st="Zip64 extra field not found",at="File contains encrypted entry",ot="Encryption not supported",ct="Compression method not supported",dt="utf-8",ht=["uncompressedSize","compressedSize","offset"],lt=["\0","☺","☻","♥","♦","♣","♠","•","◘","○","◙","♂","♀","♪","♫","☼","►","◄","↕","‼","¶","§","▬","↨","↑","↓","→","←","∟","↔","▲","▼"," ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/","0","1","2","3","4","5","6","7","8","9",":",";","<","=",">","?","@","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","[","\\","]","^","_","`","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}","~","⌂","Ç","ü","é","â","ä","à","å","ç","ê","ë","è","ï","î","ì","Ä","Å","É","æ","Æ","ô","ö","ò","û","ù","ÿ","Ö","Ü","¢","£","¥","₧","ƒ","á","í","ó","ú","ñ","Ñ","ª","º","¿","⌐","¬","½","¼","¡","«","»","░","▒","▓","│","┤","╡","╢","╖","╕","╣","║","╗","╝","╜","╛","┐","└","┴","┬","├","─","┼","╞","╟","╚","╔","╩","╦","╠","═","╬","╧","╨","╤","╥","╙","╘","╒","╓","╫","╪","┘","┌","█","▄","▌","▐","▀","α","ß","Γ","π","Σ","σ","µ","τ","Φ","Θ","Ω","δ","∞","φ","ε","∩","≡","±","≥","≤","⌠","⌡","÷","≈","°","∙","·","√","ⁿ","²","■"," "];class ut{constructor(t,e,n){this.reader=t,this.config=e,this.options=n}async getData(t,e={}){const n=this.reader;n.initialized||await n.init();const r=await n.readUint8Array(this.offset,30),i=new DataView(r.buffer),a=void 0===e.password?this.options.password:e.password;let o=a&&a.length&&a;if(this.extraFieldAES){if(99!=this.extraFieldAES.originalCompressionMethod)throw new Error(ct);if(3!=this.extraFieldAES.strength)throw new Error(ot)}if(0!=this.compressionMethod&&8!=this.compressionMethod)throw new Error(ct);if(bt(i,0)!=s)throw new Error(it);const c=this.localDirectory={};pt(c,i,4),c.rawExtraField=r.subarray(this.offset+30+c.filenameLength,this.offset+30+c.filenameLength+c.extraFieldLength),wt(this,c,i,4);let d=this.offset+30+c.filenameLength+c.extraFieldLength;const h=this.bitFlag.encrypted&&c.bitFlag.encrypted;if(h&&!o)throw new Error(at);const l=await Y(this.config,{codecType:N,codecConstructor:this.config.Inflate,inputPassword:o,inputSigned:void 0===e.checkSignature?this.options.checkSignature:e.checkSignature,inputSignature:this.signature,inputCompressed:0!=this.compressionMethod,inputEncrypted:h,useWebWorkers:void 0===e.useWebWorkers?this.options.useWebWorkers:e.useWebWorkers});return t.initialized||await t.init(),await J(l,n,t,d,this.compressedSize,this.config,{onprogress:e.onprogress}),t.getData()}}function pt(t,e,n){t.version=mt(e,n);const r=t.rawBitFlag=mt(e,n+2);t.bitFlag={encrypted:1==(1&r),level:(6&r)>>1,dataDescriptor:8==(8&r),languageEncodingFlag:(r&u)==u},t.encrypted=t.bitFlag.encrypted,t.rawLastModDate=bt(e,n+6),t.lastModDate=function(t){const e=(4294901760&t)>>16,n=65535&t;try{return new Date(1980+((65024&e)>>9),((480&e)>>5)-1,31&e,(63488&n)>>11,(2016&n)>>5,2*(31&n),0)}catch(t){}}(t.rawLastModDate),t.filenameLength=mt(e,n+22),t.extraFieldLength=mt(e,n+24)}function wt(t,e,n,i){const s=e.rawExtraField,a=e.extraField=new Map,o=new DataView(new Uint8Array(s).buffer);let c=0;try{for(;c<s.length;){const t=mt(o,c),e=mt(o,c+2);a.set(t,{type:t,data:s.slice(c+4,c+4+e)}),c+=4+e}}catch(t){}const d=mt(n,i+4);e.signature=bt(n,i+10),e.uncompressedSize=bt(n,i+18),e.compressedSize=bt(n,i+14);const h=e.extraFieldZip64=a.get(1);h&&function(t,e){e.zip64=!0;const n=new DataView(t.data.buffer);t.values=[];for(let e=0;e<Math.floor(t.data.length/8);e++)t.values.push(Number(Et(n,0+8*e)));const i=ht.filter((t=>e[t]==r));for(let e=0;e<i.length;e++)t[i[e]]=t.values[e];ht.forEach((n=>{if(e[n]==r){if(!t||void 0===t[n])throw new Error(st);e[n]=t[n]}}))}(h,e);const l=e.extraFieldUnicodePath=a.get(28789);l&&ft(l,"filename","rawFilename",e,t);let u=e.extraFieldUnicodeComment=a.get(25461);u&&ft(u,"comment","rawComment",e,t);const p=e.extraFieldAES=a.get(39169);p?function(t,e,n){if(t){const r=new DataView(t.data.buffer);t.vendorVersion=yt(r,0),t.vendorId=yt(r,2);const i=yt(r,4);t.strength=i,t.originalCompressionMethod=n,e.compressionMethod=t.compressionMethod=mt(r,5)}else e.compressionMethod=n}(p,e,d):e.compressionMethod=d,8==e.compressionMethod&&(e.bitFlag.enhancedDeflating=16!=(16&e.rawBitFlag))}function ft(t,e,n,r,i){const s=new DataView(t.data.buffer);t.version=yt(s,0),t.signature=bt(s,1);const a=new p;a.append(i[n]);const o=new DataView(new Uint8Array(4).buffer);o.setUint32(0,a.get()),t[e]=(new TextDecoder).decode(t.data.subarray(5)),i.bitFlag.languageEncodingFlag||t.signature!=bt(o,0)||(r[e]=t[e])}function gt(t,e){if(e&&"cp437"!=e.trim().toLowerCase())return new TextDecoder(e).decode(t);{let e="";for(let n=0;n<t.length;n++)e+=lt[t[n]];return e}}function yt(t,e){return t.getUint8(e)}function mt(t,e){return t.getUint16(e,!0)}function bt(t,e){return t.getUint32(e,!0)}function Et(t,e){return t.getBigUint64(e,!0)}const At="HTTP error ",Ut="HTTP Range not supported",Rt="text/plain";class Dt{constructor(){this.size=0}init(){this.initialized=!0}}class xt extends Dt{}class Ft extends Dt{writeUint8Array(t){this.size+=t.length}}class vt extends xt{constructor(t){super(),this.blob=t,this.size=t.size}readUint8Array(t,e){const n=new FileReader;return new Promise(((r,i)=>{n.onload=t=>r(new Uint8Array(t.target.result)),n.onerror=i,n.readAsArrayBuffer(this.blob.slice(t,t+e))}))}}class St extends Ft{constructor(){super(),this.array=new Uint8Array(0)}writeUint8Array(t){super.writeUint8Array(t);const e=this.array;this.array=new Uint8Array(e.length+t.length),this.array.set(e),this.array.set(t,e.length)}getData(){return this.array}}function It(t,e){return new Promise(((n,r)=>{const i=new XMLHttpRequest;i.addEventListener("load",(()=>{i.status<400?(t.size||(t.size=Number(i.getResponseHeader("Content-Length"))||Number(i.response.byteLength)),t.data=new Uint8Array(i.response),n()):r(At+(i.statusText||i.status)+".")}),!1),i.addEventListener("error",r,!1),i.open("GET",e),i.responseType="arraybuffer",i.send()}))}const Tt="File already exists",kt="Zip file comment exceeds 64KB",Lt="File entry comment exceeds 64KB",_t="File entry name exceeds 64KB",Ct="Version exceeds 65535",zt="The minimum year for the date is 1980",Mt="Extra field type exceeds 65535",Nt="Extra field data exceeds 64KB",Ot=new Uint8Array([7,0,2,0,65,69,3,0,0]);function Wt(t,e,n){t.setUint8(e,n)}function Pt(t,e,n){t.setUint16(e,n,!0)}function Vt(t,e,n){t.setUint32(e,n,!0)}function Bt(t,e,n){t.setBigUint64(e,n,!0)}const jt={chunkSize:524288,maxWorkers:"undefined"!=typeof navigator&&navigator.hardwareConcurrency||2,workerScriptsPath:void 0,useWebWorkers:!0};let Ht=Object.assign({},jt);t.BlobReader=vt,t.BlobWriter=class extends Ft{constructor(t){super(),this.offset=0,this.contentType=t,this.blob=new Blob([],{type:t})}writeUint8Array(t){super.writeUint8Array(t),this.blob=new Blob([this.blob,t.buffer],{type:this.contentType}),this.offset=this.blob.size}getData(){return this.blob}},t.Data64URIReader=class extends xt{constructor(t){super(),this.dataURI=t;let e=t.length;for(;"="==t.charAt(e-1);)e--;this.dataStart=t.indexOf(",")+1,this.size=Math.floor(.75*(e-this.dataStart))}readUint8Array(t,e){const n=new Uint8Array(e),r=4*Math.floor(t/3),i=atob(this.dataURI.substring(r+this.dataStart,4*Math.ceil((t+e)/3)+this.dataStart)),s=t-3*Math.floor(r/4);for(let t=s;t<s+e;t++)n[t-s]=i.charCodeAt(t);return n}},t.Data64URIWriter=class extends Ft{constructor(t){super(),this.data="data:"+(t||"")+";base64,",this.pending=[]}writeUint8Array(t){super.writeUint8Array(t);let e=0,n=this.pending;const r=this.pending.length;for(this.pending="",e=0;e<3*Math.floor((r+t.length)/3)-r;e++)n+=String.fromCharCode(t[e]);for(;e<t.length;e++)this.pending+=String.fromCharCode(t[e]);n.length>2?this.data+=btoa(n):this.pending=n}getData(){return this.data+btoa(this.pending)}},t.ERR_BAD_FORMAT=$,t.ERR_CENTRAL_DIRECTORY_NOT_FOUND=rt,t.ERR_DUPLICATED_NAME=Tt,t.ERR_ENCRYPTED=at,t.ERR_EOCDR_LOCATOR_ZIP64_NOT_FOUND=nt,t.ERR_EOCDR_NOT_FOUND=tt,t.ERR_EOCDR_ZIP64_NOT_FOUND=et,t.ERR_EXTRAFIELD_ZIP64_NOT_FOUND=st,t.ERR_HTTP_RANGE=Ut,t.ERR_INVALID_COMMENT=kt,t.ERR_INVALID_DATE=zt,t.ERR_INVALID_ENTRY_COMMENT=Lt,t.ERR_INVALID_ENTRY_NAME=_t,t.ERR_INVALID_EXTRAFIELD_DATA=Nt,t.ERR_INVALID_EXTRAFIELD_TYPE=Mt,t.ERR_INVALID_PASSORD=w,t.ERR_INVALID_SIGNATURE=O,t.ERR_INVALID_VERSION=Ct,t.ERR_LOCAL_FILE_HEADER_NOT_FOUND=it,t.ERR_UNSUPPORTED_COMPRESSION=ct,t.ERR_UNSUPPORTED_ENCRYPTION=ot,t.HttpRangeReader=class extends xt{constructor(t){super(),this.url=t}init(){return super.init(),new Promise(((t,e)=>{const n=new XMLHttpRequest;n.addEventListener("load",(()=>{n.status<400?(this.size=Number(n.getResponseHeader("Content-Length")),"bytes"==n.getResponseHeader("Accept-Ranges")?t():e(new Error(Ut))):e(At+(n.statusText||n.status)+".")}),!1),n.addEventListener("error",e,!1),n.open("HEAD",this.url),n.send()}))}readUint8Array(t,e){return new Promise(((n,r)=>{const i=new XMLHttpRequest;i.open("GET",this.url),i.responseType="arraybuffer",i.setRequestHeader("Range","bytes="+t+"-"+(t+e-1)),i.addEventListener("load",(()=>{i.status<400?n(new Uint8Array(i.response)):r(At+(i.statusText||i.status)+".")}),!1),i.addEventListener("error",r,!1),i.send()}))}},t.HttpReader=class extends xt{constructor(t){super(),this.url=t}async init(){if(super.init(),function(t){if("undefined"!=typeof document){const e=document.createElement("a");return e.href=t,"http:"==e.protocol||"https:"==e.protocol}return/^https?:\/\//i.test(t)}(this.url))return new Promise(((t,e)=>{const n=new XMLHttpRequest;n.addEventListener("load",(()=>{n.status<400?(this.size=Number(n.getResponseHeader("Content-Length")),this.size?t():It().then((()=>t())).catch(e)):e(At+(n.statusText||n.status)+".")}),!1),n.addEventListener("error",e,!1),n.open("HEAD",this.url),n.send()}));await It()}async readUint8Array(t,e){return this.data||await It(this,this.url),new Uint8Array(this.data.subarray(t,t+e))}},t.Reader=xt,t.TextReader=class extends xt{constructor(t){super(),this.blobReader=new vt(new Blob([t],{type:Rt}))}init(){super.init(),this.blobReader.init(),this.size=this.blobReader.size}readUint8Array(t,e){return this.blobReader.readUint8Array(t,e)}},t.TextWriter=class extends Ft{constructor(t){super(),this.encoding=t,this.blob=new Blob([],{type:Rt})}writeUint8Array(t){super.writeUint8Array(t),this.blob=new Blob([this.blob,t.buffer],{type:Rt})}getData(){const t=new FileReader;return new Promise(((e,n)=>{t.onload=t=>e(t.target.result),t.onerror=n,t.readAsText(this.blob,this.encoding)}))}},t.Uint8ArrayReader=class extends xt{constructor(t){super(),this.array=t,this.size=t.length}readUint8Array(t,e){return this.array.slice(t,t+e)}},t.Uint8ArrayWriter=St,t.Writer=Ft,t.ZipReader=class extends class{constructor(t,e={},n={}){this.reader=t,this.options=e,this.config=n}async getEntries(t={}){const e=this.reader;e.initialized||await e.init();const n=await async function(t,e,n,r){const i=new Uint8Array(4);if(function(t,e,n){t.setUint32(e,n,!0)}(new DataView(i.buffer),0,e),t.size<n)throw new Error($);const s=n+r;let a=n,o=await c(a);o||(o=await c(Math.min(s,t.size)));return o;async function c(e){const r=t.size-e,s=await t.readUint8Array(r,e);for(let t=s.length-n;t>=0;t--)if(s[t]==i[0]&&s[t+1]==i[1]&&s[t+2]==i[2]&&s[t+3]==i[3])return{offset:r,buffer:s.slice(t,t+n).buffer}}}(e,c,22,i);if(!n)throw new Error(tt);const s=new DataView(n.buffer);let a,l=bt(s,16),u=mt(s,8);if(l==r||u==i){a=!0;const t=await e.readUint8Array(n.offset-20,20),r=new DataView(t.buffer);if(Number(bt(r,0))!=h)throw new Error(et);l=Number(Et(r,8));const i=await e.readUint8Array(l,56),s=new DataView(i.buffer);if(Number(bt(s,0))!=d)throw new Error(nt);u=Number(Et(s,24)),l-=Number(Et(s,40))}if(l<0||!a&&(l>=e.size||u>=i))throw new Error($);const p=await e.readUint8Array(l,e.size-l),w=new DataView(p.buffer),f=[];let g=0;for(let e=0;e<u;e++){const e=new ut(this.reader,this.config,this.options);if(bt(w,g)!=o)throw new Error(rt);e.compressedSize=0,e.uncompressedSize=0,pt(e,w,g+6),e.commentLength=mt(w,g+32),e.directory=16==(16&yt(w,g+38)),e.offset=bt(w,g+42),e.rawFilename=p.subarray(g+46,g+46+e.filenameLength);const n=void 0===t.filenameEncoding?this.options.filenameEncoding:t.filenameEncoding;e.filename=gt(e.rawFilename,e.bitFlag.languageEncodingFlag?dt:n),!e.directory&&e.filename&&"/"==e.filename.charAt(e.filename.length-1)&&(e.directory=!0),e.rawExtraField=p.subarray(g+46+e.filenameLength,g+46+e.filenameLength+e.extraFieldLength),wt(e,e,w,g+6),e.rawComment=p.subarray(g+46+e.filenameLength+e.extraFieldLength,g+46+e.filenameLength+e.extraFieldLength+e.commentLength);const r=void 0===t.commentEncoding?this.options.commentEncoding:t.commentEncoding;e.comment=gt(e.rawComment,e.bitFlag.languageEncodingFlag?dt:r),f.push(e),g+=46+e.filenameLength+e.extraFieldLength+e.commentLength}return f}async close(){}}{constructor(t,e){super(t,e,Ht)}},t.ZipWriter=class extends class{constructor(t,e={},n={}){this.writer=t,this.options=e,this.config=n,this.files=new Map,this.offset=t.size}async add(t="",e,n={}){if(t=t.trim(),!n.directory||t.length&&"/"==t.charAt(t.length-1)||(t+="/"),this.files.has(t))throw new Error(Tt);const o=(new TextEncoder).encode(t);if(o.length>i)throw new Error(_t);const c=(new TextEncoder).encode(n.comment||"");if(c.length>i)throw new Error(Lt);const d=this.options.version||n.version||0;if(d>i)throw new Error(Ct);const h=n.lastModDate||new Date;if(h.getFullYear()<1980)throw new Error(zt);e&&!e.initialized&&await e.init();let u=new Uint8Array(0);const p=n.extraField;if(p){let t=4,e=0;p.forEach((e=>t+=e.length)),u=new Uint8Array(t),p.forEach(((t,n)=>{if(n>i)throw new Error(Mt);if(t.length>i)throw new Error(Nt);u.set(new Uint16Array([n]),e),u.set(new Uint16Array([t.length]),e+2),u.set(t,e+4),e+=4+t.length}))}const w=n.zip64||this.options.zip64||this.offset>=r||e&&(e.size>=r||this.offset+e.size>=r),f=void 0===n.password?this.options.password:n.password,g=void 0===n.level?this.options.level:n.level,y=void 0===n.useWebWorkers?this.options.useWebWorkers:n.useWebWorkers;await async function(t,e,n,i){const o=t.files,c=t.writer;let d;o.set(e,null);try{let h,u;try{i.bufferedWrite||t.options.bufferedWrite||t.lockWrite?(h=new St,h.init()):(t.lockWrite=new Promise((t=>d=t)),c.initialized||await c.init(),h=c),u=await async function(t,e,n,i){const o=i.rawFilename,c=i.lastModDate,d=i.password,h=d&&d.length,u=i.level,p=0!==u&&!i.directory,w=i.zip64;let f;if(h){f=new Uint8Array(Ot.length+2);Pt(new DataView(f.buffer),0,l),f.set(Ot,2)}else f=new Uint8Array(0);const g={version:i.version||20,zip64:w,directory:i.directory,rawFilename:o,rawComment:i.rawComment,extraFieldZip64:w?new Uint8Array(28):new Uint8Array(0),extraFieldAES:f,rawExtraField:i.rawExtraField};let y=2056,m=0;p&&(m=8);w&&(g.version=g.version>45?g.version:45);h&&(g.version=g.version>51?g.version:51,y|=1,m=99,p&&(g.extraFieldAES[9]=8));const b=g.headerArray=new Uint8Array(26),E=new DataView(b.buffer);Pt(E,0,g.version),Pt(E,2,y),Pt(E,4,m),Pt(E,6,(c.getHours()<<6|c.getMinutes())<<5|c.getSeconds()/2),Pt(E,8,(c.getFullYear()-1980<<4|c.getMonth()+1)<<5|c.getDate()),Pt(E,22,o.length),Pt(E,24,0);const A=new Uint8Array(30+o.length);let U,R,D;if(Vt(new DataView(A.buffer),0,s),A.set(b,4),A.set(o,30),t){R=t.size;const r=await Y(n,{codecType:M,codecConstructor:n.Deflate,level:u,outputPassword:d,outputSigned:!0,outputCompressed:p,outputEncrypted:h,useWebWorkers:i.useWebWorkers});await e.writeUint8Array(A),U=await J(r,t,e,0,R,n,{onprogress:i.onprogress}),D=U.length}else await e.writeUint8Array(A);const x=new Uint8Array(w?24:16),F=new DataView(x.buffer);if(Vt(F,0,a),t)if(h||void 0===U.signature||(Vt(E,10,U.signature),Vt(F,4,U.signature)),w){const t=new DataView(g.extraFieldZip64.buffer);Pt(t,0,1),Pt(t,2,24),Vt(E,14,r),Bt(F,8,BigInt(D)),Bt(t,12,BigInt(D)),Vt(E,18,r),Bt(F,16,BigInt(R)),Bt(t,4,BigInt(R))}else Vt(E,14,D),Vt(F,8,D),Vt(E,18,R),Vt(F,12,R);return await e.writeUint8Array(x),g.length=A.length+(U?U.length:0)+x.length,g}(n,h,t.config,i)}catch(t){throw o.delete(e),t}if(o.set(e,u),h!=c&&(t.lockWrite&&await t.lockWrite,await c.writeUint8Array(h.getData())),u.offset=t.offset,u.zip64){Bt(new DataView(u.extraFieldZip64.buffer),20,BigInt(u.offset))}t.offset+=u.length}finally{d&&(t.lockWrite=null,d())}}(this,t,e,Object.assign({},n,{rawFilename:o,rawComment:c,version:d,lastModDate:h,rawExtraField:u,zip64:w,password:f,level:g,useWebWorkers:y}))}async close(t=new Uint8Array(0)){const e=this.writer,n=this.files;let s=0,a=0,l=this.offset,u=n.size;if(t.length){if(!(t.length<=i))throw new Error(kt);Pt(f,s+20,t.length)}for(const[,t]of n)a+=46+t.rawFilename.length+t.rawComment.length+t.extraFieldZip64.length+t.extraFieldAES.length+t.rawExtraField.length;const p=this.options.zip64||l+a>=r||u>=i,w=new Uint8Array(a+(p?98:22)),f=new DataView(w.buffer);for(const[,t]of n){const e=t.rawFilename,n=t.extraFieldZip64,i=t.extraFieldAES,a=n.length+i.length+t.rawExtraField.length;Vt(f,s,o),Pt(f,s+4,t.version),w.set(t.headerArray,s+6),Pt(f,s+30,a),Pt(f,s+32,t.rawComment.length),t.directory&&Wt(f,s+38,16),t.zip64?Vt(f,s+42,r):Vt(f,s+42,t.offset),w.set(e,s+46),w.set(n,s+46+e.length),w.set(i,s+46+e.length+n.length),w.set(t.rawExtraField,46+e.length+n.length+i.length),w.set(t.rawComment,s+46+e.length+a),s+=46+e.length+a+t.rawComment.length}return p&&(Vt(f,s,d),Bt(f,s+4,BigInt(44)),Pt(f,s+12,45),Pt(f,s+14,45),Bt(f,s+24,BigInt(u)),Bt(f,s+32,BigInt(u)),Bt(f,s+40,BigInt(a)),Bt(f,s+48,BigInt(l)),Vt(f,s+56,h),Bt(f,s+64,BigInt(l+a)),Vt(f,s+72,1),u=i,l=r,s+=76),Vt(f,s,c),Pt(f,s+8,u),Pt(f,s+10,u),Vt(f,s+12,a),Vt(f,s+16,l),await e.writeUint8Array(w),await e.writeUint8Array(t),e.getData()}}{constructor(t,e){super(t,e,Ht)}},t.configure=function(t){if(Ht=Object.assign({},Ht,t),null!=Ht.workerScripts&&null!=Ht.workerScriptsPath)throw new Error("Either workerScripts or workerScriptsPath may be set, not both");if(Ht.workerScripts){if(Ht.workerScripts.deflate&&!Array.isArray(Ht.workerScripts.deflate))throw new Error("workerScripts.deflate must be an array");if(Ht.workerScripts.inflate&&!Array.isArray(Ht.workerScripts.inflate))throw new Error("workerScripts.inflate must be an array")}},t.getMimeType=function(){return"application/octet-stream"},t.initShimAsyncCodec=(t,e={})=>({Deflate:n(t.Deflate,e.deflate),Inflate:n(t.Inflate,e.inflate)}),Object.defineProperty(t,"__esModule",{value:!0})}));
